<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<style>
td {
	width: 80px;
	height: 80px;
}

#grid {
	table-layout: fixed;
	float:left;
}

button {
	display: block;
	width: 30px;
	margin: 5px;
}
</style>
<script>
	var numbers = [	[0b01110, 0b10001, 0b01110],
					[0b01000, 0b11111, 0b00000],
					[0b01001, 0b10011, 0b01101],
					[0b10001, 0b10101, 0b01010],
					[0b11100, 0b00100, 0b01111],
					[0b11101, 0b10101, 0b10010],
					[0b01110, 0b10101, 0b00010],
					[0b10000, 0b10111, 0b11000],
					[0b01110, 0b10101, 0b01110],
					[0b01000, 0b10101, 0b01110]]

	var date;
	var tick_id;
	var show_date = false;
	var show_number = -1;
	var columns = [[], [], []];
	var column_color = ["blue", "green", "red"];
	var show_blink = false;
	
	function write_column(col_num, value, color) {
		let end = (col_num == (show_date ? 2 : 0)) ? 5 : 6;
		for (let row = 0; row < end; row++) {
			columns[col_num][row].bgColor = value & 0x1 ? color : "unset";
			value >>= 1;
		}
	}

	function write_number(number, color) {
		for (let col = 0; col < 3; col++) {
			write_column(col, numbers[number][col], color);
		}
	}
	
	function date_part(date, part) {
		switch (part) {
		case 0:
			return show_date ? ((date.getFullYear() - 2000) % 64) : date.getHours();
		case 1:
			return show_date ? date.getMonth() + 1 : date.getMinutes();
		case 2:
			return show_date ? date.getDate() : date.getSeconds();
		}
	}

	function tick() {
		date = new Date();
		show_blink = true;
		write_output();
		columns[show_date ? 2 : 0][5].bgColor = "yellow";
		setTimeout(function() { show_blink = false; columns[show_date ? 2 : 0][5].bgColor = "unset"; }, 250);
	}

	function write_output() {
		if (show_number >= 0) {
			let part = 2 - Math.floor(show_number / 2);
			let number = date_part(date, part);
			let color = column_color[part];
			if (show_number % 2) {
				number = Math.floor(number / 10);
			} else {
				number %= 10;
			}
			write_number(number, color);
			columns[1][5].bgColor = show_number % 2 ? "yellow" : "unset";

			show_number -= 1;
		} else {
			for (let i = 0; i < 3; i++) {
				write_column(i, date_part(date, i), column_color[i]);
			}
		}
		if (show_blink) {
			columns[show_date ? 2 : 0][5].bgColor = "yellow";
		}
	}

	function init_table() {
		var cells = document.getElementById("grid").getElementsByTagName("td");
		for (let i = 0; i < 18; i++) {
			columns[i % 3].unshift(cells[i]);
		}

		tick();
		date = new Date();
		tick_id = setInterval(tick, 1000);
	}
	
	function btn_click(e) {
		switch (e) {
		case "menu":
			if (show_number < 0) {
				show_number = 5;
			} else {
				show_number = -1;
				write_output();
			}
			break;
		case "neg":
			show_date = !show_date;
			if (show_number >= 0) {
				show_number = -1;
			}
			write_output();
			break;
		case "pos":
			break;
		}
	}
</script>
</head>
<body onload="init_table()" style="background: black;">
<table id="grid">
<tr><td></td><td></td><td></td></tr>
<tr><td></td><td></td><td></td></tr>
<tr><td></td><td></td><td></td></tr>
<tr><td></td><td></td><td></td></tr>
<tr><td></td><td></td><td></td></tr>
<tr><td></td><td></td><td></td></tr>
</table>
<button name="menu" onclick="btn_click(this.name)">M</button>
<button name="neg" onclick="btn_click(this.name)">0</button>
<button name="pos" onclick="btn_click(this.name)">1</button>
<div style="clear: left; color: white; font-family: sans-serif;">
<p>This is a demo for a binary clock I want to build.</p>
<p>The left (blue) column is either hour or year, the middle (green) column is either minute or month and the right (red) column is either second or day.</p>
<p>If it displays the date it'll flash in the top right corner and otherwise in the top left. By using the "0" it'll switch between date and time.</p>
<p>The "M" button enables a "human readable" output. It'll show each "column" as two digits, the tens digit will have a "yellow" dot in the top row center. The order and color will be the same as for the binary output.</p>
</body>
</html>